#!/usr/bin/env cwl-runner

class: Workflow

inputs:
  - id: "#tumor_bam_path"
    type: File
  - id: "#normal_bam_path"
    type: File
  - id: "#reference_fasta_name"
    type: File
  - id: "#reference_fasta_fai"
    type: File
  - id: "#dbsnp_known_snp_sites"
    type: File
  - id: "#Parallel_Block_Size"
    type: string
  - id: "#thread_count"
    type: string
  - id: "#case_id"
    type: string
  - id: "#normal_id"
    type: string
  - id: "#tumor_id"
    type: string
  - id: "#username"
    type: string
  - id: "#password"
    type: string

outputs:
  - id: "#muse_call_merged_output"
    type: File
    source: "#muse_call.merged_output"
  - id: "#muse_sump_wxs_output_vcf"
    type: File
    source: "#muse_sump_wxs.output_vcf"
  - id: "#muse_call_log"
    type: File
    source: "#muse_call.log"
  - id: "#muse_sump_wxs_log"
    type: File
    source: "#muse_sump_wxs.log"

steps:
  - id: "#muse_call"
    run: {import: ../tools/muse_call.cwl.yaml}
    inputs:
      - id: "#muse_call.tumor_bam_path"
        source: "#tumor_bam_path"
      - id: "#muse_call.normal_bam_path"
        source: "#normal_bam_path"
      - id: "#muse_call.reference_fasta_name"
        source: "#reference_fasta_name"
      - id: "#muse_call.reference_fasta_fai"
        source: "#reference_fasta_fai"
      - id: "#muse_call.thread_count"
        source: "#thread_count"
      - id: "#muse_call.Parallel_Block_Size"
        source: "#Parallel_Block_Size"
      - id: "#muse_call.case_id"
        source: "#case_id"
      - id: "#muse_call.normal_id"
        source: "#normal_id"
      - id: "#muse_call.tumor_id"
        source: "#tumor_id"
      - id: "#muse_call.username"
        source: "#username"
      - id: "#muse_call.password"
        source: "#password"

    outputs:
      - id: "#muse_call.output_list"
      - id: "#muse_call.merged_output"
      - id: "#muse_call.log"

  - id: "#muse_sump_wxs"
    run: {import: ../tools/muse_sump_wxs.cwl.yaml}
    inputs:
      - id: "#muse_sump_wxs.muse_call_output_path"
        source: "#muse_call.merged_output"
      - id: "#muse_sump_wxs.dbsnp_known_snp_sites"
        source: "#dbsnp_known_snp_sites"
      - id: "#muse_sump_wxs.case_id"
        source: "#case_id"
      - id: "#muse_sump_wxs.normal_id"
        source: "#normal_id"
      - id: "#muse_sump_wxs.tumor_id"
        source: "#tumor_id"
      - id: "#muse_sump_wxs.username"
        source: "#username"
      - id: "#muse_sump_wxs.password"
        source: "#password"

    outputs:
      - id: "#muse_sump_wxs.output_vcf"
      - id: "#muse_sump_wxs.log"
